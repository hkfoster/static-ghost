
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Keeping Elasticsearch secure - the Compose network</title>
  <meta name="description" content="">

  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="shortcut icon" href="../favicon.ico">

  <script>
  // Uncomment for testing purposes
  // localStorage.clear();
  
  // Place in <head> above all stylesheet declarations
  function loadFont( fontName, woffUrl, woff2Url ) {
  
    // Test for support
    var browser   = navigator.userAgent,
        noSupport = !window.addEventListener || ( browser.match( /(Android (2|3|4.0|4.1|4.2|4.3))|(Opera (Mini|Mobi))/ ) && !browser.match( /Chrome/ ) );
  
    // Return if not supported
    if ( noSupport ) {
      return;
    }
  
    // Set up localStorage
    var loSto = {};
    try {
      loSto = localStorage || {};
    } catch ( ex ) {}
  
    var localStoragePrefix = 'x-font-' + fontName,
        localStorageUrlKey = localStoragePrefix + 'url',
        localStorageCssKey = localStoragePrefix + 'css',
        storedFontUrl      = loSto[ localStorageUrlKey ],
        storedFontCss      = loSto[ localStorageCssKey ];
  
    // Set up <style> element
    var styleElement = document.createElement( 'style' );
    styleElement.rel = 'stylesheet';
    document.head.appendChild( styleElement );
  
    // localStorage check
    if ( storedFontCss && ( storedFontUrl === woffUrl || storedFontUrl === woff2Url ) ) {
  
      // Apply font style sheet
      styleElement.textContent = storedFontCss;
  
    } else {
  
      // Apply new font (WOFF2 if supported)
      var url = ( woff2Url && supportsWoff2() ) ? woff2Url : woffUrl;
  
      // Fetch font data
      var request = new XMLHttpRequest();
      request.open( 'GET', url );
      request.onload = function() {
        if ( request.status >= 200 && request.status < 400 ) {
  
          // Update localStorage
          loSto[ localStorageUrlKey ] = url;
          loSto[ localStorageCssKey ] = styleElement.textContent = request.responseText;
        }
      };
      request.send();
    }
  
    // Check for WOFF2 support
    function supportsWoff2() {
      if ( !window.FontFace ) {
        return false;
      }
  
      var f = new FontFace( 't', 'url( "data:application/font-woff2," ) format( "woff2" )' );
      f.load();
  
      return f.status === 'loading';
    }
  }
  
  // Instantiate font loader
  loadFont(
    'Proxima Nova',
    '/assets/css/fonts-woff.css?v=682061ecfb',
    '/assets/css/fonts-woff2.css?v=682061ecfb'
  );
  </script>
  <link rel="stylesheet" type="text/css" href="../assets/css/style.css?v=682061ecfb">

  <link rel="canonical" href="http://localhost:2368/keeping-elasticsearch-secure-the-compose-network/">
    
    <meta property="og:site_name" content="Compose Articles">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Keeping Elasticsearch secure - the Compose network">
    <meta property="og:description" content="People have asked us “You run Elasticsearch databases, how do you secure them?”. It’s a good question to ask because Elasticsearch doesn’t have any authentication mechanisms built in, or users or roles or anything that resembles them. Elasticsearch...">
    <meta property="og:url" content="http://localhost:2368/keeping-elasticsearch-secure-the-compose-network/">
    <meta property="og:image" content="http://localhost:2368/content/images/2014/12/elasticsecure_lguzk4_ap1v9w.jpg">
    <meta property="article:published_time" content="2014-08-28T11:24:59.000Z">
    <meta property="article:modified_time" content="2014-12-17T09:38:13.000Z">
    <meta property="article:tag" content="elasticsearch">
    <meta property="article:tag" content="HAProxy">
    <meta property="article:tag" content="private network">
    <meta property="article:tag" content="ssh">
    <meta property="article:tag" content="vlan">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Keeping Elasticsearch secure - the Compose network">
    <meta name="twitter:description" content="People have asked us “You run Elasticsearch databases, how do you secure them?”. It’s a good question to ask because Elasticsearch doesn’t have any authentication mechanisms built in, or users or roles or anything that resembles them. Elasticsearch...">
    <meta name="twitter:url" content="http://localhost:2368/keeping-elasticsearch-secure-the-compose-network/">
    <meta name="twitter:image:src" content="http://localhost:2368/content/images/2014/12/elasticsecure_lguzk4_ap1v9w.jpg">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Compose Articles",
    "author": {
        "@type": "Person",
        "name": "Dj",
        "image": "//www.gravatar.com/avatar/3c427b45eb4d51770a5ec7f9e4d62c9f?d=404&s=250",
        "url": "http://localhost:2368/author/dj",
        "sameAs": ""
    },
    "headline": "Keeping Elasticsearch secure - the Compose network",
    "url": "http://localhost:2368/keeping-elasticsearch-secure-the-compose-network/",
    "datePublished": "2014-08-28T11:24:59.000Z",
    "dateModified": "2014-12-17T09:38:13.000Z",
    "image": "http://localhost:2368/content/images/2014/12/elasticsecure_lguzk4_ap1v9w.jpg",
    "keywords": "elasticsearch, HAProxy, private network, ssh, vlan",
    "description": "People have asked us “You run Elasticsearch databases, how do you secure them?”. It’s a good question to ask because Elasticsearch doesn’t have any authentication mechanisms built in, or users or roles or anything that resembles them. Elasticsearch..."
}
    </script>

    <meta name="generator" content="Ghost 0.5">
    <link rel="alternate" type="application/rss+xml" title="Compose Articles" href="http://localhost:2368/rss/">
</head>

<body class="post-template tag-elasticsearch-2 tag-haproxy tag-private-network tag-ssh tag-vlan blend-mode">

  <header class="branding" role="banner">
    <a class="logo" href="../"><span class="hidden">Compose</span></a>
    <a class="menu-trigger" href="index.html#?"></a>
    <nav class="main-nav" data-yield="primary_nav" role="navigation">
      <a href="http://127.0.0.1:2368/mongodb/">MongoDB</a>
      <a href="http://127.0.0.1:2368/elasticsearch/">Elasticsearch</a>
      <a href="http://127.0.0.1:2368/rethinkdb/">RethinkDB</a>
      <a href="http://127.0.0.1:2368/redis/">Redis</a>
      <a href="http://127.0.0.1:2368/postgresql/">PostgreSQL</a>
      <a href="https://app.compose.io">Sign in</a>
      <a class="signup" href="../signup/">Sign up</a>
    </nav>
  </header>
  <main class="content container" role="main">

    


<article class="post tag-elasticsearch-2 tag-haproxy tag-private-network tag-ssh tag-vlan container">
  <header class="hero cover-image container" style="background-image: url(../content/images/2014/12/elasticsecure_lguzk4_ap1v9w.jpg)">
    <h1 class="post-title">Keeping Elasticsearch secure - the Compose network</h1>
    <small class="post-meta"><time class="post-date" datetime="2014-08-28">August 28th, 2014</time></small>
  </header>

<p>People have asked us “You run Elasticsearch databases, how do you secure them?”. It’s a good question to ask because Elasticsearch doesn’t have any authentication mechanisms built in, or users or roles or anything that resembles them. Elasticsearch has been built to not be exposed to the shared corporate network, let alone the internet. It has been built to run on a private network importing data and delivering search results to systems connected to that private network.</p>

<p><img src="../content/images/2014/12/database_lock_stretch3_apkmfr_dyz0vn.png" alt="Database Security" title="">If you are running your own local Elasticsearch, you may be able to work around that requirement or be prepared to take on the risk. Unfortunately, too many developers carry that risk over onto their cloud deployments as they scale up, leaving themselves vulnerable. We engineer our systems to embrace best practice and the model that all databases should be run on private networks, especially when they live in the cloud. So how do we do it?</p>

<h2 id="fromtheprocessup">From the process up</h2>

<p>It starts at the process level in our Elasticsearch clusters. Each one of them is runs in an isolated container on their host system and is connected to a dedicated VLAN. Our VLAN’s run on top of a software-defined network (SDN) that allows us to create the right, highly controlled and isolated, network architecture. To implement that SDN, we use <a href="http://openvswitch.org">Open vSwitch</a>, an open source, production quality, multilayer virtual switch.</p>

<p>Each one of the Elasticsearch containers has a private interface to a VLAN which allows it to communicate with other containers within the cluster. None of them have a public interface. It’s not just Elasticsearch containers on the VLAN though. We also have “entry point” containers which are designed to purely handle incoming access. These entry points have separate private and public interfaces and are responsible for managing the transit of communications between the two.</p>

<p>Currently we are in production with a HAProxy entry point container. More often used solely for load balancing, <a href="http://www.haproxy.org">HAProxy</a> can also enforce authentication on incoming HTTPS connections. Thats why, when you get your Compose Elasticsearch set up, you can create users. Those users are administered by the HAProxy entry point. Once authenticated there, the requests are forwarded to the appropriate node on the cluster. Your connection is HTTPS secured and authenticated by the HAProxy and sent on into the already private network where the cluster lives. For many uses of Elasticsearch that gives sufficient access and control.</p>

<h2 id="beyondproxies">Beyond proxies</h2>

<p>We aren’t resting yet. One of the popular uses of Elasticsearch is to use it with <a href="http://logstash.net">Logstash</a>, the event and log management system. Logstash ships logs in from any source then uses Elasticsearch to power its parsing, indexing, timestamping and, of course, search. But it connects using <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/modules-transport.html">Transport</a> which is typically used for internal communicates between the nodes of a cluster. It does this to be more efficient when pushing data into the search cluster. There’s only one problem: that internal protocol doesn’t go across our HAProxy entry point as that’s built for REST protocol users.</p>

<p>That is why we are currently have in private beta an SSH-Tunnel entry point. This allows customers to create a secure tunnel into the private network from their own network so they can have authenticated access for the Transport protocol. While this is being tested with Elasticsearch, we are also considering it as a potential entry point for out MongoDB deployments. We are able to do that because we built the Compose platform to be reusable.</p>

<h2 id="forwardandforwarding">Forward and forwarding</h2>

<p>The Compose architecture for Elasticsearch is the same architecture we have developed to run MongoDB safely and securely. Any database running in the cloud should be running on a clean, managed private network and access to that network should be tightly controlled through authenticating, encrypting, hardened entry points. It isn’t a hand-configured deployment either; our networking deployment goes hand in hand with our automatic database deployment.</p>

<p>As we continue to develop the Compose architecture, with our current and future database offerings, we won’t deviate from delivering that safe environment for your data to work in. We’re already looking at future entry point containers, such as VPNs, and how we can give you more control over those entry points.</p>


<footer class="post-footer big-push">


    <figure class="author">
      <a href="../author/dj/">
        <img src="http://www.gravatar.com/avatar/3c427b45eb4d51770a5ec7f9e4d62c9f?d=404&amp;s=250" alt="Dj">
      </a>
      <figcaption>
        <p>Written on <time class="post-date" datetime="2015-03-13">March 13th, 2015</time> by</p>
        <a href="../author/dj/">Dj</a>
          <p>Content Curator at Compose, Dj has been both a developer and writer since Apples came in ][ flavors and Commodores had Pets.</p>
      </figcaption>
    </figure>




  <nav class="post-nav">
    <section class="site-nav">
      <a class="article-index" data-tooltip="Article Index" href="http://localhost:2368">
        <span class="hidden">Article Index</span>
        <svg>
          <use xlink:href="/assets/images/icons.svg#index"></use>
        </svg>
      </a>
      <a class="subscribe-button" data-tooltip="Suscribe" href="http://localhost:2368/rss/">
        <span class="hidden">Subscribe</span>
        <svg>
          <use xlink:href="/assets/images/icons.svg#subscribe"></use>
        </svg>
      </a>
    </section>
    <section class="share-nav">
      <a class="twitter-button" data-tooltip="Share on Twitter" href="https://twitter.com/share?text=Keeping%20Elasticsearch%20secure%20-%20the%20Compose%20network&amp;url=http://localhost:2368/keeping-elasticsearch-secure-the-compose-network/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
        <svg>
          <use xlink:href="/assets/images/icons.svg#twitter"></use>
        </svg>
      </a>
      <a class="facebook-button" data-tooltip="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/keeping-elasticsearch-secure-the-compose-network/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
        <svg>
          <use xlink:href="/assets/images/icons.svg#facebook"></use>
        </svg>
      </a>
      <a class="google-plus-button" data-tooltip="Share on Google Plus" href="https://plus.google.com/share?url=http://localhost:2368/keeping-elasticsearch-secure-the-compose-network/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
        <svg>
          <use xlink:href="/assets/images/icons.svg#google-plus"></use>
        </svg>
      </a>
    </section></nav>
  
</footer>

</article>



  </main>

  <footer class="colophon full-push" role="contentinfo">
    <nav>
      <dl>
        <dt>Company</dt>
        <dd><a href="http://127.0.0.1:2368/about-us/">About Us</a><a href="http://blog.compose.io/">Blog</a><a href="http://docs.compose.io/policies">Policies</a><a href="http://127.0.0.1:2368/pricing/">Plans <span class="amp">&amp;</span> Pricing </a><a href="http://127.0.0.1:2368/database-as-a-service/">Database as a Service</a>
        </dd>
      </dl>
      <dl>
        <dt>Support</dt>
        <dd><a href="http://status.compose.io/">System Status</a><a href="http://docs.compose.io/">Support</a><a href="http://docs.compose.io/">Docs</a><a href="http://127.0.0.1:2368/security/">Security</a><a href="https://docs.compose.io/support/new_request.html/?page=www">Contact Us</a>
        </dd>
      </dl>
      <dl>
        <dt>Databases</dt>
        <dd><a href="http://127.0.0.1:2368/mongodb/">MongoDB</a><a href="http://127.0.0.1:2368/elasticsearch/">Elasticsearch</a><a href="http://127.0.0.1:2368/rethinkdb/">RethinkDB</a><a href="http://127.0.0.1:2368/redis/">Redis</a><a href="http://127.0.0.1:2368/enhanced/">Enhanced</a>
        </dd>
      </dl>
      <dl>
        <dt>Deployments</dt>
        <dd><a href="http://127.0.0.1:2368/aws/">AWS</a><a href="http://127.0.0.1:2368/digitalocean/">DigitalOcean</a><a href="http://127.0.0.1:2368/softlayer/">SoftLayer</a><a href="http://127.0.0.1:2368/gogrid/">GoGrid</a>
        </dd>
      </dl>
    </nav>
    <p>© 2015 Compose. All rights reserved. </p>
  </footer>
  <script src="../public/jquery.js?v=682061ecfb"></script>

  <script type="text/javascript" src="../assets/js/site.js?v=682061ecfb"></script>

</body>
