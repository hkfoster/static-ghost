
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Customising MongoDB's Shell With Compact Prompts</title>
  <meta name="description" content="">

  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="shortcut icon" href="../favicon.ico">

  <script>
  // Uncomment for testing purposes
  // localStorage.clear();
  
  // Place in <head> above all stylesheet declarations
  function loadFont( fontName, woffUrl, woff2Url ) {
  
    // Test for support
    var browser   = navigator.userAgent,
        noSupport = !window.addEventListener || ( browser.match( /(Android (2|3|4.0|4.1|4.2|4.3))|(Opera (Mini|Mobi))/ ) && !browser.match( /Chrome/ ) );
  
    // Return if not supported
    if ( noSupport ) {
      return;
    }
  
    // Set up localStorage
    var loSto = {};
    try {
      loSto = localStorage || {};
    } catch ( ex ) {}
  
    var localStoragePrefix = 'x-font-' + fontName,
        localStorageUrlKey = localStoragePrefix + 'url',
        localStorageCssKey = localStoragePrefix + 'css',
        storedFontUrl      = loSto[ localStorageUrlKey ],
        storedFontCss      = loSto[ localStorageCssKey ];
  
    // Set up <style> element
    var styleElement = document.createElement( 'style' );
    styleElement.rel = 'stylesheet';
    document.head.appendChild( styleElement );
  
    // localStorage check
    if ( storedFontCss && ( storedFontUrl === woffUrl || storedFontUrl === woff2Url ) ) {
  
      // Apply font style sheet
      styleElement.textContent = storedFontCss;
  
    } else {
  
      // Apply new font (WOFF2 if supported)
      var url = ( woff2Url && supportsWoff2() ) ? woff2Url : woffUrl;
  
      // Fetch font data
      var request = new XMLHttpRequest();
      request.open( 'GET', url );
      request.onload = function() {
        if ( request.status >= 200 && request.status < 400 ) {
  
          // Update localStorage
          loSto[ localStorageUrlKey ] = url;
          loSto[ localStorageCssKey ] = styleElement.textContent = request.responseText;
        }
      };
      request.send();
    }
  
    // Check for WOFF2 support
    function supportsWoff2() {
      if ( !window.FontFace ) {
        return false;
      }
  
      var f = new FontFace( 't', 'url( "data:application/font-woff2," ) format( "woff2" )' );
      f.load();
  
      return f.status === 'loading';
    }
  }
  
  // Instantiate font loader
  loadFont(
    'Proxima Nova',
    '/assets/css/fonts-woff.css?v=682061ecfb',
    '/assets/css/fonts-woff2.css?v=682061ecfb'
  );
  </script>
  <link rel="stylesheet" type="text/css" href="../assets/css/style.css?v=682061ecfb">

  <link rel="canonical" href="http://localhost:2368/customising-mongodbs-shell-with-compact-prompts/">
    
    <meta property="og:site_name" content="Compose Articles">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Customising MongoDB's Shell With Compact Prompts">
    <meta property="og:description" content="TL;DR: It’s easy to customise the Mongo shell’s prompt, especially if If you use MongoDB shell with one of MongoHQ’s Elastic Deployments, you will have noticed that your replica set name is not as catchy as...">
    <meta property="og:url" content="http://localhost:2368/customising-mongodbs-shell-with-compact-prompts/">
    <meta property="article:published_time" content="2014-05-22T10:33:01.000Z">
    <meta property="article:modified_time" content="2014-09-02T09:00:58.000Z">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Customising MongoDB's Shell With Compact Prompts">
    <meta name="twitter:description" content="TL;DR: It’s easy to customise the Mongo shell’s prompt, especially if If you use MongoDB shell with one of MongoHQ’s Elastic Deployments, you will have noticed that your replica set name is not as catchy as...">
    <meta name="twitter:url" content="http://localhost:2368/customising-mongodbs-shell-with-compact-prompts/">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Compose Articles",
    "author": {
        "@type": "Person",
        "name": "Dj",
        "image": "//www.gravatar.com/avatar/3c427b45eb4d51770a5ec7f9e4d62c9f?d=404&s=250",
        "url": "http://localhost:2368/author/dj",
        "sameAs": ""
    },
    "headline": "Customising MongoDB&#x27;s Shell With Compact Prompts",
    "url": "http://localhost:2368/customising-mongodbs-shell-with-compact-prompts/",
    "datePublished": "2014-05-22T10:33:01.000Z",
    "dateModified": "2014-09-02T09:00:58.000Z",
    "description": "TL;DR: It’s easy to customise the Mongo shell’s prompt, especially if If you use MongoDB shell with one of MongoHQ’s Elastic Deployments, you will have noticed that your replica set name is not as catchy as..."
}
    </script>

    <meta name="generator" content="Ghost 0.5">
    <link rel="alternate" type="application/rss+xml" title="Compose Articles" href="http://localhost:2368/rss/">
</head>

<body class="post-template blend-mode">

  <header class="branding" role="banner">
    <a class="logo" href="../"><span class="hidden">Compose</span></a>
    <a class="menu-trigger" href="index.html#?"></a>
    <nav class="main-nav" data-yield="primary_nav" role="navigation">
      <a href="http://127.0.0.1:2368/mongodb/">MongoDB</a>
      <a href="http://127.0.0.1:2368/elasticsearch/">Elasticsearch</a>
      <a href="http://127.0.0.1:2368/rethinkdb/">RethinkDB</a>
      <a href="http://127.0.0.1:2368/redis/">Redis</a>
      <a href="http://127.0.0.1:2368/postgresql/">PostgreSQL</a>
      <a href="https://app.compose.io">Sign in</a>
      <a class="signup" href="../signup/">Sign up</a>
    </nav>
  </header>
  <main class="content container" role="main">

    


<article class="post container">
  <header>
    <h1 class="post-title">Customising MongoDB's Shell With Compact Prompts</h1>
    <small class="post-meta"><time class="post-date" datetime="2014-05-22">May 22nd, 2014</time></small>
  </header>

<p>TL;DR: It’s easy to customise the Mongo shell’s prompt, especially if If you use MongoDB shell with one of MongoHQ’s Elastic Deployments, you will have noticed that your replica set name is not as catchy as it could be. You <strong>will</strong> have noticed it because that replica set name appears in your Mongo shell prompt by default. So your prompt looks something like this…</p>

<p><code>set-5345738b13a3efb950000d32:PRIMARY&gt;</code></p>

<p>That’s a bit noisy and probably not telling you much unless you have excellent skills memorising and comparing hex strings. It is also telling you whether you are connected to the primary or secondary. Thats at least 37 characters and you are nearly half way across the screen before you start typing. What would probably be more useful is a shorter customised prompt that tells you what you want to know. Here we’ll show you how in a couple of steps.</p>

<p>The prompt in Mongo shell is derived from a variable called prompt; if its not defined, then the shell shows us its default. The best place to set that is in your .mongorc.js file but before we do that let’s see what we can do with it in the shell.</p>

<h2 id="losingtheprompt">Losing the prompt</h2>

<p>The first thing you might want to do is just strip down the prompt. To do that you can set prompt to a string:</p>

<p><code>set-5345738b13a3efb950000d32:PRIMARY&gt; var prompt="&gt;"</code> <br>
<code>&gt;</code></p>

<p>If you aren’t keen on the minimalism, just <code>delete prompt</code> to return to the default prompt. You can always set the variable to something more informative. Let’s put the database name into the prompt:</p>

<p><code>&gt;var prompt=db.getName()+"&gt;"</code> <br>
<code>exemplum&gt;</code></p>

<h2 id="thetroublewithtime">The trouble with time</h2>

<p>Of course we have to remember that the value of the prompt when set like that, is unchanging. So if we put the time in prompt like so:</p>

<p><code>exemplum&gt;var prompt=ISODate().toLocaleTimeString()+"&gt;"</code> <br>
<code>14:53:38&gt;</code></p>

<p>it would always be 14:53:38. To have a dynamic prompt, we need to set prompt to a function, so that evaluating it will make the function return an newly calculated value.</p>

<p><code>14:53:38&gt;var prompt=function(){ return ISODate().toLocaleTimeString()+"&gt;"; }</code> <br>
<code>14:56:35&gt;</code> <br>
<code>14:56:38&gt;</code></p>

<p>Now the time will update when it displays the prompt. We’re using the time here as its the most easily accessible changing value for all users. It could be any other statistic you want to display, but do remember that statistic will be calculated every time the prompt is displayed.</p>

<h2 id="makingitstick">Making it stick</h2>

<p>We’re already getting to the point where we want to make this more permanant, so exit the shell and open an editor on your .mongorc.js file. You’ll find it in your $HOME directory on Unix systems. We can set the prompt variable in there and create our own, ever smarter, version by adding this to .mongorc.js:</p>

<pre><code>&lt;code class="language-javascript"&gt;var prompt=function() {  
        var dbname=db.getName();
        var master=db.isMaster().ismaster;
        var dblabel=master?dbname:"("+dbname+")"
        var time=ISODate().toLocaleTimeString();
        return dblabel+"/"+time+"&gt;";
}
</code></pre>

<p>Here, the dbname is shown with parentheses around it if we are talking to a secondary node, and no parentheses if the primary, and adds in the local time to our compact prompt. That gives us a neat prompt:</p>

<p><code>exemplum/15:20:30&gt;</code></p>

<p>And that replica set name we hid at the start? If you need that, just run <code>db.isMaster().setName</code> in the shell.</p>

<p>Now you can go and customise your prompt to what you need and get it displayed in the compact (or verbose) form you prefer. And when you’ve come up with your perfect custom prompt why not share it with us by mailing it to <a href="mailto:dj@mongohq.com">dj@mongohq.com</a> and we’ll publish them in a future article.</p>


<footer class="post-footer big-push">


    <figure class="author">
      <a href="../author/dj/">
        <img src="http://www.gravatar.com/avatar/3c427b45eb4d51770a5ec7f9e4d62c9f?d=404&amp;s=250" alt="Dj">
      </a>
      <figcaption>
        <p>Written on <time class="post-date" datetime="2015-03-13">March 13th, 2015</time> by</p>
        <a href="../author/dj/">Dj</a>
          <p>Content Curator at Compose, Dj has been both a developer and writer since Apples came in ][ flavors and Commodores had Pets.</p>
      </figcaption>
    </figure>




  <nav class="post-nav">
    <section class="site-nav">
      <a class="article-index" data-tooltip="Article Index" href="http://localhost:2368">
        <span class="hidden">Article Index</span>
        <svg>
          <use xlink:href="/assets/images/icons.svg#index"></use>
        </svg>
      </a>
      <a class="subscribe-button" data-tooltip="Suscribe" href="http://localhost:2368/rss/">
        <span class="hidden">Subscribe</span>
        <svg>
          <use xlink:href="/assets/images/icons.svg#subscribe"></use>
        </svg>
      </a>
    </section>
    <section class="share-nav">
      <a class="twitter-button" data-tooltip="Share on Twitter" href="https://twitter.com/share?text=Customising%20MongoDB's%20Shell%20With%20Compact%20Prompts&amp;url=http://localhost:2368/customising-mongodbs-shell-with-compact-prompts/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
        <svg>
          <use xlink:href="/assets/images/icons.svg#twitter"></use>
        </svg>
      </a>
      <a class="facebook-button" data-tooltip="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/customising-mongodbs-shell-with-compact-prompts/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
        <svg>
          <use xlink:href="/assets/images/icons.svg#facebook"></use>
        </svg>
      </a>
      <a class="google-plus-button" data-tooltip="Share on Google Plus" href="https://plus.google.com/share?url=http://localhost:2368/customising-mongodbs-shell-with-compact-prompts/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
        <svg>
          <use xlink:href="/assets/images/icons.svg#google-plus"></use>
        </svg>
      </a>
    </section></nav>
  
</footer>

</article>



  </main>

  <footer class="colophon full-push" role="contentinfo">
    <nav>
      <dl>
        <dt>Company</dt>
        <dd><a href="http://127.0.0.1:2368/about-us/">About Us</a><a href="http://blog.compose.io/">Blog</a><a href="http://docs.compose.io/policies">Policies</a><a href="http://127.0.0.1:2368/pricing/">Plans <span class="amp">&amp;</span> Pricing </a><a href="http://127.0.0.1:2368/database-as-a-service/">Database as a Service</a>
        </dd>
      </dl>
      <dl>
        <dt>Support</dt>
        <dd><a href="http://status.compose.io/">System Status</a><a href="http://docs.compose.io/">Support</a><a href="http://docs.compose.io/">Docs</a><a href="http://127.0.0.1:2368/security/">Security</a><a href="https://docs.compose.io/support/new_request.html/?page=www">Contact Us</a>
        </dd>
      </dl>
      <dl>
        <dt>Databases</dt>
        <dd><a href="http://127.0.0.1:2368/mongodb/">MongoDB</a><a href="http://127.0.0.1:2368/elasticsearch/">Elasticsearch</a><a href="http://127.0.0.1:2368/rethinkdb/">RethinkDB</a><a href="http://127.0.0.1:2368/redis/">Redis</a><a href="http://127.0.0.1:2368/enhanced/">Enhanced</a>
        </dd>
      </dl>
      <dl>
        <dt>Deployments</dt>
        <dd><a href="http://127.0.0.1:2368/aws/">AWS</a><a href="http://127.0.0.1:2368/digitalocean/">DigitalOcean</a><a href="http://127.0.0.1:2368/softlayer/">SoftLayer</a><a href="http://127.0.0.1:2368/gogrid/">GoGrid</a>
        </dd>
      </dl>
    </nav>
    <p>© 2015 Compose. All rights reserved. </p>
  </footer>
  <script src="../public/jquery.js?v=682061ecfb"></script>

  <script type="text/javascript" src="../assets/js/site.js?v=682061ecfb"></script>

</body>
